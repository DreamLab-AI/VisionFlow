# VisionFlow Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values.
# NEVER commit .env to version control.
#
# Generate secrets with: openssl rand -hex 32
# =============================================================================

# =============================================================================
# GitHub Data Source (REQUIRED)
# These control which repository/branch/path the ontology is fetched from.
# No hardcoded fallbacks — the server will error if these are missing.
# =============================================================================
GITHUB_OWNER=jjohare
GITHUB_REPO=logseq
GITHUB_BRANCH=main
GITHUB_TOKEN=
GITHUB_BASE_PATH=mainKnowledgeGraph/pages
# GITHUB_RATE_LIMIT=true
# GITHUB_API_VERSION=v3

# =============================================================================
# Neo4j Database (REQUIRED)
# IMPORTANT: Use the Docker service name "neo4j", NOT "localhost".
# Code fallback is bolt://localhost:7687 which breaks inside containers.
# =============================================================================
NEO4J_URI=bolt://neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=
NEO4J_DATABASE=neo4j
# NEO4J_MAX_CONNECTIONS=50
# NEO4J_QUERY_TIMEOUT=30
# NEO4J_CONNECTION_TIMEOUT=10

# =============================================================================
# Security & Authentication (REQUIRED for production)
# =============================================================================
JWT_SECRET=
JWT_EXPIRATION=3600
SESSION_SECRET=
SESSION_TIMEOUT=1800
MANAGEMENT_API_KEY=

# WebSocket Security
WS_AUTH_ENABLED=true
WS_AUTH_TOKEN=
WS_MAX_CONNECTIONS=100
WS_CONNECTION_TIMEOUT=300000
TCP_MAX_CONNECTIONS=50
TCP_CONNECTION_TIMEOUT=300000

# WARNING: Set to true ONLY for local development
SETTINGS_AUTH_BYPASS=false
# ALLOW_INSECURE_DEFAULTS=true

# Nostr Authentication — comma-separated public keys
APPROVED_PUBKEYS=
POWER_USER_PUBKEYS=
SETTINGS_SYNC_ENABLED_PUBKEYS=
# AUTH_TOKEN_EXPIRY=3600

# Per-service pubkey ACLs
PERPLEXITY_ENABLED_PUBKEYS=
OPENAI_ENABLED_PUBKEYS=
RAGFLOW_ENABLED_PUBKEYS=

# =============================================================================
# Server & Networking
# =============================================================================
BIND_ADDRESS=0.0.0.0
SYSTEM_NETWORK_PORT=4000
DOMAIN=www.visionflow.info
DEBUG_ENABLED=true
DEBUG_MODE=true
RUST_LOG=info,actix_web=info
RUST_BACKTRACE=1
SETTINGS_FILE_PATH=/app/settings.yaml

# CORS — comma-separated origins
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:5173,https://www.visionflow.info
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Input Validation
MAX_REQUEST_SIZE=10485760
MAX_FIELD_SIZE=1048576
ALLOWED_FILE_TYPES=.jpg,.png,.pdf,.txt,.md
SANITIZE_HTML=true

# =============================================================================
# Data Paths (container-internal)
# =============================================================================
DATA_ROOT=/app/data
MARKDOWN_DIR=/app/data/markdown
METADATA_DIR=/app/data/metadata

# =============================================================================
# MCP / Multi-Agent Control Plane
# All services should resolve to the same host via this single variable.
# =============================================================================
CLAUDE_FLOW_HOST=agentic-workstation
MCP_HOST=agentic-workstation
MCP_TCP_PORT=9500
MCP_TRANSPORT=tcp
MCP_RECONNECT_ATTEMPTS=3
MCP_RECONNECT_DELAY=1000
MCP_CONNECTION_TIMEOUT=30000

# Management API
MANAGEMENT_API_HOST=agentic-workstation
MANAGEMENT_API_PORT=9090
MANAGEMENT_API_URL=http://agentic-workstation:9090

# Orchestrator / Bots
ORCHESTRATOR_WS_URL=ws://agentic-workstation:3002/ws
BOTS_ORCHESTRATOR_URL=ws://agentic-workstation:3002/ws
# PRIMARY_PROVIDER=gemini

# RuVector Swarm (multi-agent discovery)
# RUV_SWARM_HOST=localhost
# RUV_SWARM_PORT=9501
# DAA_HOST=localhost
# DAA_PORT=9502

# =============================================================================
# GPU / CUDA Configuration
# =============================================================================
# NO_GPU_COMPUTE=true
NVIDIA_VISIBLE_DEVICES=0
CUDA_ARCH=89
# CUDA_DEVICE=0
# CUDA_VISIBLE_DEVICES=0
# GPU_MEMORY_FRACTION=0.8
# VISIONFLOW_PTX_PATH=

# =============================================================================
# External AI Services (all optional)
# =============================================================================

# RAGFlow
RAGFLOW_API_KEY=
RAGFLOW_API_BASE_URL=http://ragflow-server:9380
RAGFLOW_AGENT_ID=

# Perplexity
PERPLEXITY_API_KEY=
PERPLEXITY_MODEL=llama-3.1-sonar-small-128k-online
PERPLEXITY_MAX_TOKENS=4096
PERPLEXITY_TEMPERATURE=0.5
PERPLEXITY_TOP_P=0.9
PERPLEXITY_PRESENCE_PENALTY=0.0
PERPLEXITY_FREQUENCY_PENALTY=1.0
PERPLEXITY_API_URL=https://api.perplexity.ai/chat/completions

# OpenAI
OPENAI_API_KEY=
OPENAI_BASE_URL=wss://api.openai.com/v1/realtime
OPENAI_TIMEOUT=30
OPENAI_RATE_LIMIT=100

# Google Gemini
GOOGLE_GEMINI_API_KEY=

# DeepSeek
DEEPSEEK_API_KEY=
DEEPSEEK_BASE_URL=https://api.deepseek.com

# =============================================================================
# Solid Protocol (Self-Sovereign Data)
# =============================================================================
# SOLID_INTERNAL_URL=http://127.0.0.1:4001/api/solid
# SOLID_IDP_URL=http://localhost:3000
# SOLID_POD_URL=http://localhost:3001
# SOLID_PROXY_SECRET_KEY=
# SOLID_ALLOW_ANONYMOUS=true
JSS_URL=http://visionflow-jss:3030
# JSS_WS_URL=

# =============================================================================
# Vision / Content Generation
# =============================================================================
# COMFYUI_URL=http://comfyui:8188
# COMFYUI_SALAD_URL=http://comfyui:3000
VISIONFLOW_AGENT_KEY=

# =============================================================================
# Data Sync
# =============================================================================
FORCE_FULL_SYNC=1

# =============================================================================
# Cloudflare Tunnel
# =============================================================================
CLOUDFLARE_TUNNEL_TOKEN=
# TUNNEL_ID=

# =============================================================================
# Redis (optional — session persistence)
# =============================================================================
# REDIS_URL=

# =============================================================================
# Logging & Monitoring
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=json
# LOG_DIR=./logs
ENABLE_ACCESS_LOGS=true
ENABLE_ERROR_LOGS=true
LOG_RETENTION_DAYS=7

# Performance Monitoring
PERFORMANCE_MONITORING=true
# PERFORMANCE_TRACE_ENABLED=true
# BOTTLENECK_DETECTION=true
# LATENCY_TRACKING=true

# Telemetry (disabled by default)
TELEMETRY_ENABLED=false
# TELEMETRY_LOG_LEVEL=error
# TELEMETRY_METRICS_INTERVAL=30000
# TELEMETRY_GPU_MONITORING=false
# TELEMETRY_NETWORK_MONITORING=false

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PORT=9501
HEALTH_CHECK_PATH=/health

# Docker
DOCKER_REGISTRY_MIRROR=registry-1.docker.io

# =============================================================================
# Debug Logging (uncomment for verbose debugging)
# =============================================================================
# MCP_LOG_LEVEL=debug
# MCP_TCP_DEBUG=true
# MCP_CONNECTION_LOGGING=true
# MCP_TOOL_CALL_LOGGING=true
# MCP_RESPONSE_LOGGING=true
# MCP_PROTOCOL_TRACE=true
# DOCKER_EXEC_LOGGING=true
# DOCKER_EXEC_TRACE=true
# DOCKER_COMMAND_DEBUG=true
# DOCKER_HIVE_MIND_OPERATIONS=true
# DOCKER_PROCESS_LIFECYCLE=true
# AGENT_CONTROL_LOG_LEVEL=debug
# AGENT_SPAWN_LOGGING=true
# AGENT_LIFECYCLE_TRACKING=true
# AGENT_TELEMETRY_STREAMING=true
# AGENT_STATUS_POLLING=true
# HYBRID_CONTROL_DEBUG=true
# TCP_MCP_DATA_PLANE_LOGGING=true
# DOCKER_EXEC_CONTROL_PLANE_LOGGING=true
# CROSS_CONTAINER_BRIDGE_LOGGING=true
# NETWORK_STATE_MONITORING=false
# CONNECTION_HEALTH_CHECKS=false
# RETRY_OPERATION_LOGGING=false
# CIRCUIT_BREAKER_LOGGING=false
