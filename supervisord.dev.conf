[supervisord]
nodaemon=true
logfile=/app/logs/supervisord.log
loglevel=info

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
stdout_logfile=/app/logs/nginx.log
stderr_logfile=/app/logs/nginx-error.log
stdout_logfile_maxbytes=50MB
stderr_logfile_maxbytes=50MB
stdout_logfile_backups=3
stderr_logfile_backups=3

[program:rust-backend]
command=/app/scripts/rust-backend-wrapper.sh
autostart=true
autorestart=true
stdout_logfile=/app/logs/rust.log
stderr_logfile=/app/logs/rust-error.log
stdout_logfile_maxbytes=50MB
stderr_logfile_maxbytes=50MB
stdout_logfile_backups=3
stderr_logfile_backups=3
environment=RUST_LOG="%(ENV_RUST_LOG)s",RUST_BACKTRACE=1,SYSTEM_NETWORK_PORT=4000,MCP_TCP_PORT=9500,MCP_TRANSPORT=tcp,CLAUDE_FLOW_HOST=multi-agent-container,DOCKER_ENV=1

[program:vite-dev]
command=/bin/bash -c "cd /app/client && npm run dev"
autostart=true
autorestart=true
stdout_logfile=/app/logs/vite.log
stderr_logfile=/app/logs/vite-error.log
stdout_logfile_maxbytes=50MB
stderr_logfile_maxbytes=50MB
stdout_logfile_backups=3
stderr_logfile_backups=3
environment=NODE_ENV=development,VITE_DEV_SERVER_PORT=5173,VITE_API_PORT=4000,VITE_HMR_PORT=24678

[unix_http_server]
file=/tmp/supervisor.sock

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface