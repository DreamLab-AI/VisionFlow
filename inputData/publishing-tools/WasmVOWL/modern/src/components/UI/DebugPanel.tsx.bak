/**
 * Debug panel for force simulation debugging
 */

import { useDebugControls } from '../../hooks/useDebugControls';

export function DebugPanel() {
  const {
    isOpen,
    setIsOpen,
    config,
    updateConfig,
    enableAll,
    disableAll,
    logCurrentDistribution,
    exportPositions,
  } = useDebugControls();

  if (!isOpen) {
    return (
      <button
        className="fixed top-20 right-5 z-[1000] px-4 py-2.5 bg-gray-800 dark:bg-gray-700 text-white border-0 rounded-lg cursor-pointer text-sm font-medium shadow-md hover:bg-gray-700 dark:hover:bg-gray-600 hover:-translate-y-px hover:shadow-lg active:translate-y-0 transition-all"
        onClick={() => setIsOpen(true)}
        title="Open debug panel"
      >
        üêõ Debug
      </button>
    );
  }

  return (
    <div className="fixed top-20 right-5 w-[350px] max-h-[calc(100vh-100px)] bg-gray-900 dark:bg-gray-950 text-gray-200 rounded-xl shadow-2xl z-[1000] overflow-hidden flex flex-col">
      <div className="flex justify-between items-center px-5 py-4 bg-gray-800 dark:bg-gray-900 border-b border-gray-700">
        <h3 className="m-0 text-base font-semibold">üêõ Force Simulation Debug</h3>
        <button
          onClick={() => setIsOpen(false)}
          className="bg-transparent border-0 text-gray-200 text-xl cursor-pointer p-0 w-6 h-6 flex items-center justify-center rounded hover:bg-gray-700 transition-all"
        >
          ‚úï
        </button>
      </div>

      <div className="flex-1 overflow-y-auto px-5 py-4 custom-scrollbar">
        {/* Quick Actions */}
        <div className="mb-5">
          <h4 className="m-0 mb-2.5 text-sm font-semibold text-gray-400 uppercase tracking-wider">Quick Actions</h4>
          <div className="grid grid-cols-2 gap-2">
            <button onClick={enableAll} className="px-3 py-2 bg-blue-600 text-white border-0 rounded-md cursor-pointer text-xs font-medium hover:bg-blue-700 hover:-translate-y-px transition-all">Enable All</button>
            <button onClick={disableAll} className="px-3 py-2 bg-blue-600 text-white border-0 rounded-md cursor-pointer text-xs font-medium hover:bg-blue-700 hover:-translate-y-px transition-all">Disable All</button>
            <button onClick={logCurrentDistribution} className="px-3 py-2 bg-blue-600 text-white border-0 rounded-md cursor-pointer text-xs font-medium hover:bg-blue-700 hover:-translate-y-px transition-all">Log Distribution</button>
            <button onClick={exportPositions} className="px-3 py-2 bg-blue-600 text-white border-0 rounded-md cursor-pointer text-xs font-medium hover:bg-blue-700 hover:-translate-y-px transition-all">Export Positions</button>
          </div>
        </div>

        {/* Force Logging */}
        <div className="mb-5">
          <h4 className="m-0 mb-2.5 text-sm font-semibold text-gray-400 uppercase tracking-wider">Force Logging</h4>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logForces}
              onChange={(e) => updateConfig({ logForces: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Forces
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logRepulsion}
              onChange={(e) => updateConfig({ logRepulsion: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Repulsion
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logAttraction}
              onChange={(e) => updateConfig({ logAttraction: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Attraction
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logCentering}
              onChange={(e) => updateConfig({ logCentering: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Centering
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logBarnesHut}
              onChange={(e) => updateConfig({ logBarnesHut: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Barnes-Hut
          </label>
        </div>

        {/* Position & Velocity */}
        <div className="mb-5">
          <h4 className="m-0 mb-2.5 text-sm font-semibold text-gray-400 uppercase tracking-wider">Position & Velocity</h4>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logPositions}
              onChange={(e) => updateConfig({ logPositions: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Positions
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logVelocities}
              onChange={(e) => updateConfig({ logVelocities: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Velocities
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logPositionHistory}
              onChange={(e) => updateConfig({ logPositionHistory: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Track Position History
          </label>
        </div>

        {/* Performance */}
        <div className="mb-5">
          <h4 className="m-0 mb-2.5 text-sm font-semibold text-gray-400 uppercase tracking-wider">Performance</h4>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logFPS}
              onChange={(e) => updateConfig({ logFPS: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log FPS
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logIterations}
              onChange={(e) => updateConfig({ logIterations: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Iterations
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.logAlpha}
              onChange={(e) => updateConfig({ logAlpha: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Log Alpha
          </label>
        </div>

        {/* Visualization */}
        <div className="mb-5">
          <h4 className="m-0 mb-2.5 text-sm font-semibold text-gray-400 uppercase tracking-wider">Visualization</h4>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.showQuadtree}
              onChange={(e) => updateConfig({ showQuadtree: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Show Quadtree
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.showForceVectors}
              onChange={(e) => updateConfig({ showForceVectors: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Show Force Vectors
          </label>
          <label className="flex items-center mb-2 text-sm cursor-pointer select-none hover:text-gray-100">
            <input
              type="checkbox"
              checked={config.highlightClusters}
              onChange={(e) => updateConfig({ highlightClusters: e.target.checked })}
              className="mr-2.5 cursor-pointer"
            />
            Highlight Clusters
          </label>
        </div>

        {/* Settings */}
        <div className="mb-5">
          <h4 className="m-0 mb-2.5 text-sm font-semibold text-gray-400 uppercase tracking-wider">Settings</h4>
          <label className="text-sm">
            Log Interval:
            <input
              type="number"
              value={config.logInterval}
              onChange={(e) => updateConfig({ logInterval: parseInt(e.target.value) || 10 })}
              min="1"
              max="100"
              className="ml-2.5 px-2 py-1 bg-gray-800 border border-gray-700 rounded text-gray-200 w-15"
            />
          </label>
        </div>

        {/* Info */}
        <div className="bg-gray-800 p-3 rounded text-xs text-gray-400">
          <p className="my-1">üí° Open browser console to see logs</p>
          <p className="my-1">üîç Use window.wasmvowlDebug for advanced debugging</p>
        </div>
      </div>
    </div>
  );
}
