# Grafana Observability Stack Configuration

# Grafana Configuration
grafana:
  # Grafana base URL
  url: "https://grafana.example.com"

  # Grafana API key (create in Settings > API Keys)
  # Permissions: Viewer (read), Editor (write), or Admin (full)
  api_key: "your-grafana-api-key-here"

  # Optional: Organization ID (defaults to current org)
  # org_id: 1

  # Optional: Default folder for searches
  # default_folder: "Production"

# Prometheus Configuration
prometheus:
  # Prometheus base URL
  url: "http://prometheus:9090"

  # Optional: Basic auth
  # username: "prometheus"
  # password: "secret"

  # Optional: Default query timeout
  # timeout: "30s"

  # Optional: Default step for range queries
  # default_step: "1m"

# Loki Configuration
loki:
  # Loki base URL
  url: "http://loki:3100"

  # Optional: Basic auth
  # username: "loki"
  # password: "secret"

  # Optional: Default query limit
  # default_limit: 100

  # Optional: Default lookback duration
  # default_since: "1h"

# Query Configuration
queries:
  # Maximum results per query
  max_results: 1000

  # Default timeout for all queries
  timeout: 30

  # Enable query caching
  cache_enabled: true

  # Cache TTL in seconds
  cache_ttl: 300

# Alert Configuration
alerts:
  # Check interval for alert status
  check_interval: 60

  # Alert states to monitor
  monitored_states:
    - alerting
    - pending

  # Ignore alerts from these folders
  ignored_folders: []

# Dashboard Configuration
dashboards:
  # Auto-refresh interval for dashboards
  refresh_interval: 300

  # Default folder for new dashboards
  default_folder: "General"

  # Dashboard tags to index
  indexed_tags:
    - production
    - staging
    - critical

# Kubernetes Service Discovery (if applicable)
kubernetes:
  # Use in-cluster service names
  enabled: false

  # Namespace where monitoring stack is deployed
  namespace: "monitoring"

  # Service names
  services:
    grafana: "grafana"
    prometheus: "prometheus"
    loki: "loki"

# Example Kubernetes Configuration
# grafana:
#   url: "http://grafana.monitoring.svc.cluster.local:3000"
#   api_key: "${GRAFANA_API_KEY}"
#
# prometheus:
#   url: "http://prometheus.monitoring.svc.cluster.local:9090"
#
# loki:
#   url: "http://loki.monitoring.svc.cluster.local:3100"

# Security Configuration
security:
  # Validate SSL certificates
  verify_ssl: true

  # SSL certificate path (if using custom CA)
  # ca_cert: "/path/to/ca.crt"

  # Client certificate authentication
  # client_cert: "/path/to/client.crt"
  # client_key: "/path/to/client.key"

# Logging Configuration
logging:
  # Log level: DEBUG, INFO, WARNING, ERROR
  level: "INFO"

  # Log format: json, text
  format: "json"

  # Log file path (empty for stdout)
  file: ""

# Performance Tuning
performance:
  # Connection pool size
  pool_size: 10

  # Request timeout in seconds
  timeout: 30

  # Max retries for failed requests
  max_retries: 3

  # Retry backoff factor
  backoff_factor: 0.3

# Common Query Presets
query_presets:
  cpu_usage:
    prometheus: "rate(node_cpu_seconds_total{mode!='idle'}[5m])"
    description: "CPU usage rate"

  memory_usage:
    prometheus: "100 * (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes))"
    description: "Memory usage percentage"

  error_logs:
    loki: '{job="app"} |= "error"'
    description: "Application error logs"

  http_errors:
    prometheus: 'rate(http_requests_total{status=~"5.."}[5m])'
    description: "HTTP 5xx error rate"
