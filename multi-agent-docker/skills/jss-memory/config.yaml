# JSS Memory Skill Configuration
# Solid Pod memory persistence for AI agents with claude-flow integration

name: jss-memory
version: 1.0.0
description: Solid Pod memory persistence for AI agents with JSON-LD semantic structure

# Skill metadata
metadata:
  author: VisionFlow
  license: MIT
  repository: https://github.com/visionflow/jss-memory
  documentation: https://visionflow.local/docs/skills/jss-memory
  tags:
    - memory
    - persistence
    - solid-pod
    - claude-flow
    - semantic
    - json-ld

# Claude-flow hooks integration
hooks:
  pre-task:
    handler: hooks/jss-memory-sync.js
    export: pre-task
    description: Load agent memory from pod before task execution
    timeout: 30000

  post-task:
    handler: hooks/jss-memory-sync.js
    export: post-task
    description: Save task results to pod as episodic memory
    timeout: 30000

  session-restore:
    handler: hooks/jss-memory-sync.js
    export: session-restore
    description: Load previous session state from pod
    timeout: 60000

  session-end:
    handler: hooks/jss-memory-sync.js
    export: session-end
    description: Save session summary and metrics to pod
    timeout: 60000

# Required environment variables
requires:
  - name: SOLID_POD_URL
    description: URL of the Solid Pod server (JSS via nginx proxy)
    default: http://localhost:4000/solid
    required: true
    alternatives:
      docker_internal: http://jss:3030
      development: http://localhost:3030

  - name: NOSTR_SESSION_TOKEN
    description: Nostr session token for authentication
    required: false
    sensitive: true

  - name: JSS_CACHE_DIR
    description: Local cache directory for offline operation
    default: /tmp/jss-memory-cache
    required: false

  - name: JSS_DEBUG
    description: Enable debug logging
    default: "false"
    required: false

# Optional configuration
optional:
  - name: JSS_MAX_RETRIES
    description: Maximum retry attempts for pod operations
    default: 3

  - name: JSS_RETRY_DELAY
    description: Delay between retries in milliseconds
    default: 1000

  - name: JSS_MEMORY_TTL
    description: Default TTL for episodic memories in seconds
    default: 86400

  - name: JSS_EMBEDDING_MODEL
    description: Model to use for generating embeddings
    default: text-embedding-3-small

# Memory types supported
memory_types:
  episodic:
    description: Task-specific memories with temporal context
    path_template: /agent-{type}/memories/episodic/
    retention: 30d

  semantic:
    description: Factual knowledge and relationships
    path_template: /agent-{type}/memories/semantic/
    retention: permanent

  procedural:
    description: Learned patterns and workflows
    path_template: /agent-{type}/memories/procedural/
    retention: permanent

  session:
    description: Session state and summaries
    path_template: /agent-{type}/sessions/
    retention: 7d

# Agent type configurations (54 agent types across 9 categories)
agent_types:
  # ============================================================================
  # Core Development (5 agents)
  # ============================================================================
  coder:
    category: core-development
    memory_capacity: 1000
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [code-generation, refactoring, debugging]

  reviewer:
    category: core-development
    memory_capacity: 500
    consolidation_threshold: 0.85
    default_confidence: 0.95
    specializations: [code-review, best-practices, security-review]

  tester:
    category: core-development
    memory_capacity: 500
    consolidation_threshold: 0.8
    default_confidence: 0.9
    specializations: [unit-testing, integration-testing, e2e-testing]

  planner:
    category: core-development
    memory_capacity: 1500
    consolidation_threshold: 0.65
    default_confidence: 0.8
    specializations: [task-decomposition, sprint-planning, roadmapping]

  researcher:
    category: core-development
    memory_capacity: 2000
    consolidation_threshold: 0.6
    default_confidence: 0.75
    specializations: [literature-review, technology-research, competitive-analysis]

  # ============================================================================
  # Swarm Coordination (5 agents)
  # ============================================================================
  hierarchical-coordinator:
    category: swarm-coordination
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [tree-coordination, delegation, escalation]

  mesh-coordinator:
    category: swarm-coordination
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [peer-coordination, load-distribution, fault-tolerance]

  adaptive-coordinator:
    category: swarm-coordination
    memory_capacity: 2500
    consolidation_threshold: 0.65
    default_confidence: 0.8
    specializations: [topology-switching, self-organization, dynamic-routing]

  collective-intelligence-coordinator:
    category: swarm-coordination
    memory_capacity: 3000
    consolidation_threshold: 0.6
    default_confidence: 0.75
    specializations: [emergent-behavior, swarm-learning, collective-decision]

  swarm-memory-manager:
    category: swarm-coordination
    memory_capacity: 5000
    consolidation_threshold: 0.5
    default_confidence: 0.9
    specializations: [memory-sharing, knowledge-transfer, pattern-extraction]

  # ============================================================================
  # Consensus & Distributed (7 agents)
  # ============================================================================
  byzantine-coordinator:
    category: consensus-distributed
    memory_capacity: 1500
    consolidation_threshold: 0.9
    default_confidence: 0.95
    specializations: [byzantine-fault-tolerance, voting, trust-management]

  raft-manager:
    category: consensus-distributed
    memory_capacity: 1000
    consolidation_threshold: 0.85
    default_confidence: 0.95
    specializations: [leader-election, log-replication, cluster-management]

  gossip-coordinator:
    category: consensus-distributed
    memory_capacity: 1500
    consolidation_threshold: 0.7
    default_confidence: 0.8
    specializations: [epidemic-broadcast, membership-protocol, failure-detection]

  consensus-builder:
    category: consensus-distributed
    memory_capacity: 2000
    consolidation_threshold: 0.8
    default_confidence: 0.9
    specializations: [multi-party-consensus, conflict-resolution, agreement-protocols]

  crdt-synchronizer:
    category: consensus-distributed
    memory_capacity: 1500
    consolidation_threshold: 0.75
    default_confidence: 0.9
    specializations: [eventual-consistency, merge-operations, conflict-free-replication]

  quorum-manager:
    category: consensus-distributed
    memory_capacity: 1000
    consolidation_threshold: 0.85
    default_confidence: 0.95
    specializations: [quorum-calculation, read-write-quorum, availability-optimization]

  security-manager:
    category: consensus-distributed
    memory_capacity: 1500
    consolidation_threshold: 0.9
    default_confidence: 0.95
    specializations: [access-control, encryption, audit-logging]

  # ============================================================================
  # Performance & Optimization (5 agents)
  # ============================================================================
  perf-analyzer:
    category: performance-optimization
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [profiling, bottleneck-detection, resource-analysis]

  performance-benchmarker:
    category: performance-optimization
    memory_capacity: 1500
    consolidation_threshold: 0.75
    default_confidence: 0.9
    specializations: [benchmark-design, metric-collection, comparison-analysis]

  task-orchestrator:
    category: performance-optimization
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [task-scheduling, dependency-resolution, parallel-execution]

  memory-coordinator:
    category: performance-optimization
    memory_capacity: 3000
    consolidation_threshold: 0.6
    default_confidence: 0.8
    specializations: [memory-allocation, caching-strategy, garbage-collection]

  smart-agent:
    category: performance-optimization
    memory_capacity: 2500
    consolidation_threshold: 0.65
    default_confidence: 0.8
    specializations: [self-optimization, adaptive-behavior, learning-from-feedback]

  # ============================================================================
  # GitHub & Repository (9 agents)
  # ============================================================================
  github-modes:
    category: github-repository
    memory_capacity: 1500
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [github-api, repository-management, webhook-handling]

  pr-manager:
    category: github-repository
    memory_capacity: 1000
    consolidation_threshold: 0.8
    default_confidence: 0.9
    specializations: [pull-request-review, merge-strategy, conflict-resolution]

  code-review-swarm:
    category: github-repository
    memory_capacity: 2000
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [multi-reviewer-coordination, review-aggregation, feedback-synthesis]

  issue-tracker:
    category: github-repository
    memory_capacity: 1500
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [issue-triage, labeling, priority-assignment]

  release-manager:
    category: github-repository
    memory_capacity: 1000
    consolidation_threshold: 0.85
    default_confidence: 0.9
    specializations: [version-management, changelog-generation, release-notes]

  workflow-automation:
    category: github-repository
    memory_capacity: 1500
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [github-actions, ci-cd, automation-pipelines]

  project-board-sync:
    category: github-repository
    memory_capacity: 1000
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [project-management, kanban, status-tracking]

  repo-architect:
    category: github-repository
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.8
    specializations: [repository-structure, monorepo-management, code-organization]

  multi-repo-swarm:
    category: github-repository
    memory_capacity: 2500
    consolidation_threshold: 0.65
    default_confidence: 0.8
    specializations: [cross-repo-coordination, dependency-management, sync-operations]

  # ============================================================================
  # SPARC Methodology (6 agents)
  # ============================================================================
  sparc-coord:
    category: sparc-methodology
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [sparc-orchestration, phase-coordination, workflow-management]

  sparc-coder:
    category: sparc-methodology
    memory_capacity: 1500
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [sparc-implementation, code-refinement, completion-phase]

  specification:
    category: sparc-methodology
    memory_capacity: 1500
    consolidation_threshold: 0.7
    default_confidence: 0.8
    specializations: [requirements-analysis, specification-writing, acceptance-criteria]

  pseudocode:
    category: sparc-methodology
    memory_capacity: 1000
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [algorithm-design, logic-flow, pseudocode-generation]

  architecture:
    category: sparc-methodology
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.8
    specializations: [system-design, component-architecture, integration-patterns]

  refinement:
    category: sparc-methodology
    memory_capacity: 1500
    consolidation_threshold: 0.8
    default_confidence: 0.85
    specializations: [tdd-implementation, iterative-improvement, code-polish]

  # ============================================================================
  # Specialized Development (8 agents)
  # ============================================================================
  backend-dev:
    category: specialized-development
    memory_capacity: 1500
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [api-development, database-design, server-architecture]

  mobile-dev:
    category: specialized-development
    memory_capacity: 1500
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [ios-development, android-development, cross-platform]

  ml-developer:
    category: specialized-development
    memory_capacity: 2500
    consolidation_threshold: 0.65
    default_confidence: 0.8
    specializations: [model-training, data-pipeline, ml-ops]

  cicd-engineer:
    category: specialized-development
    memory_capacity: 1500
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [pipeline-design, deployment-automation, infrastructure-as-code]

  api-docs:
    category: specialized-development
    memory_capacity: 1000
    consolidation_threshold: 0.8
    default_confidence: 0.9
    specializations: [api-documentation, openapi-spec, developer-guides]

  system-architect:
    category: specialized-development
    memory_capacity: 2500
    consolidation_threshold: 0.65
    default_confidence: 0.8
    specializations: [distributed-systems, scalability, system-integration]

  code-analyzer:
    category: specialized-development
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.85
    specializations: [static-analysis, code-metrics, dependency-analysis]

  base-template-generator:
    category: specialized-development
    memory_capacity: 1000
    consolidation_threshold: 0.8
    default_confidence: 0.9
    specializations: [scaffolding, boilerplate, project-templates]

  # ============================================================================
  # Testing & Validation (2 agents)
  # ============================================================================
  tdd-london-swarm:
    category: testing-validation
    memory_capacity: 2000
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [london-school-tdd, mock-driven-design, outside-in-testing]

  production-validator:
    category: testing-validation
    memory_capacity: 1500
    consolidation_threshold: 0.85
    default_confidence: 0.95
    specializations: [production-readiness, compliance-checking, deployment-validation]

  # ============================================================================
  # Migration & Planning (2 agents)
  # ============================================================================
  migration-planner:
    category: migration-planning
    memory_capacity: 2000
    consolidation_threshold: 0.7
    default_confidence: 0.8
    specializations: [migration-strategy, data-migration, legacy-modernization]

  swarm-init:
    category: migration-planning
    memory_capacity: 1500
    consolidation_threshold: 0.75
    default_confidence: 0.85
    specializations: [swarm-bootstrapping, agent-provisioning, topology-initialization]

  # ============================================================================
  # Default fallback for unknown agent types
  # ============================================================================
  default:
    category: general
    memory_capacity: 500
    consolidation_threshold: 0.7
    default_confidence: 0.8
    specializations: [general-purpose]

# Schema configuration
schema:
  context_url: https://visionflow.local/ontology/agent-memory.jsonld
  local_path: ../schemas/agent-memory.jsonld
  version: "1.1"

# Pod storage structure
pod_structure:
  base_path: /
  containers:
    - name: agent-{type}
      description: Container for agent-specific data
      children:
        - name: memories
          description: Agent memory storage
          children:
            - name: episodic
              description: Episodic memories
            - name: semantic
              description: Semantic knowledge
            - name: procedural
              description: Procedural patterns
        - name: sessions
          description: Session state and summaries
        - name: config
          description: Agent configuration

# Claude-flow coordination
coordination:
  namespace: coordination
  key_prefix: swarm
  sync_interval: 5000
  broadcast_events:
    - memory_stored
    - session_started
    - session_ended
    - pattern_learned

# Performance settings
performance:
  cache_enabled: true
  cache_ttl: 300
  batch_writes: true
  batch_size: 10
  batch_interval: 5000
  compression: true
  compression_threshold: 1024

# Logging configuration
logging:
  level: info
  format: json
  include_timestamps: true
  log_memory_access: false
  log_pod_operations: true

# Health check
health:
  enabled: true
  interval: 60000
  pod_connectivity_check: true
  cache_size_threshold: 100mb

# Feature flags
features:
  embedding_generation: false
  similarity_search: false
  memory_consolidation: true
  cross_agent_sharing: true
  automatic_cleanup: true
  metrics_collection: true

# MCP tool definitions (for future integration)
tools:
  - name: jss_store_memory
    description: Store a memory to the agent's pod
    parameters:
      - name: agentType
        type: string
        required: true
      - name: memoryType
        type: string
        enum: [episodic, semantic, procedural]
        default: episodic
      - name: content
        type: object
        required: true
      - name: confidence
        type: number
        default: 0.8

  - name: jss_retrieve_memory
    description: Retrieve a specific memory from the pod
    parameters:
      - name: memoryId
        type: string
        required: true
      - name: agentType
        type: string
        required: true

  - name: jss_search_memories
    description: Search agent memories by query
    parameters:
      - name: agentType
        type: string
        required: true
      - name: query
        type: string
        required: true
      - name: memoryType
        type: string
        default: episodic
      - name: limit
        type: integer
        default: 10

  - name: jss_get_session
    description: Get current or previous session data
    parameters:
      - name: sessionId
        type: string
        required: true
      - name: agentType
        type: string
        required: true
